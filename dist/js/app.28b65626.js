(function(o){function t(t){for(var s,r,n=t[0],c=t[1],l=t[2],p=0,d=[];p<n.length;p++)r=n[p],a[r]&&d.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(o[s]=c[s]);h&&h(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),e()}function e(){for(var o,t=0;t<i.length;t++){for(var e=i[t],s=!0,n=1;n<e.length;n++){var c=e[n];0!==a[c]&&(s=!1)}s&&(i.splice(t--,1),o=r(r.s=e[0]))}return o}var s={},a={app:0},i=[];function r(t){if(s[t])return s[t].exports;var e=s[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=o,r.c=s,r.d=function(o,t,e){r.o(o,t)||Object.defineProperty(o,t,{enumerable:!0,get:e})},r.r=function(o){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,t){if(1&t&&(o=r(o)),8&t)return o;if(4&t&&"object"===typeof o&&o&&o.__esModule)return o;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:o}),2&t&&"string"!=typeof o)for(var s in o)r.d(e,s,function(t){return o[t]}.bind(null,s));return e},r.n=function(o){var t=o&&o.__esModule?function(){return o["default"]}:function(){return o};return r.d(t,"a",t),t},r.o=function(o,t){return Object.prototype.hasOwnProperty.call(o,t)},r.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var l=0;l<n.length;l++)t(n[l]);var h=c;i.push([0,"chunk-vendors"]),e()})({0:function(o,t,e){o.exports=e("56d7")},"0313":function(o,t,e){"use strict";var s=e("f601"),a=e.n(s);a.a},"034f":function(o,t,e){"use strict";var s=e("64a9"),a=e.n(s);a.a},"08e1":function(o,t,e){o.exports=e.p+"img/search.3e88b530.svg"},"3dfc":function(o,t,e){o.exports=e.p+"img/404.cc893b02.png"},"53a2":function(o,t,e){"use strict";var s=e("a6e4"),a=e.n(s);a.a},"56d7":function(o,t,e){"use strict";e.r(t);e("cadf"),e("551c"),e("f751"),e("097d");var s=e("2b0e"),a=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},i=[],r=(e("034f"),e("2877")),n={},c=Object(r["a"])(n,a,i,!1,null,null,null),l=c.exports,h=e("8c4f"),p=function(){var o=this,t=o.$createElement,s=o._self._c||t;return s("div",[o.$root.loading?s("Loading"):o._e(),o.$root.page.mybook.show_search?o._e():s("div",{staticClass:"header"},[s("div",{staticClass:"header-buttons-left"},[o.$root.page.mybook.show_history?o._e():s("span",{staticClass:"icon flex_center",attrs:{title:"打开阅读记录"}},[s("img",{staticClass:"icon",attrs:{src:e("d0ad")},on:{click:function(t){o.$root.page.mybook.show_history=!o.$root.page.mybook.show_history}}})]),o.$root.page.mybook.show_history?s("span",{staticClass:"icon flex_center",attrs:{title:"关掉阅读记录"},on:{click:function(t){o.$root.page.mybook.show_history=!o.$root.page.mybook.show_history}}},[s("img",{staticClass:"icon",attrs:{src:e("e67b")}})]):o._e(),o.$root.page.mybook.show_history?o._e():s("span",{staticClass:"icon flex_center margin075",attrs:{title:"随机来点书"},on:{click:function(t){return o.get_random_books()}}},[s("img",{staticClass:"icon",attrs:{src:e("a714")}})])]),o.$root.page.mybook.show_history?o._e():s("span",{staticClass:"icon flex_center",attrs:{title:"显示搜索框"},on:{click:function(t){o.$root.page.mybook.show_search=!o.$root.page.mybook.show_search}}},[s("img",{staticClass:"icon",attrs:{src:e("08e1")}})])]),o.$root.page.mybook.show_search?s("div",{staticClass:"header"},[s("input",{directives:[{name:"model",rawName:"v-model",value:o.$root.page.mybook.keyword,expression:"$root.page.mybook.keyword"},{name:"focus",rawName:"v-focus"}],attrs:{type:"text",placeholder:"搜索书名、作者"},domProps:{value:o.$root.page.mybook.keyword},on:{input:[function(t){t.target.composing||o.$set(o.$root.page.mybook,"keyword",t.target.value)},function(t){return o.get_books_by_keyword(o.$root.page.mybook.keyword)}]}}),s("div",{staticClass:"header-buttons"},[s("span",{staticClass:"icon flex_center",attrs:{title:"关掉搜索框"},on:{click:function(t){o.$root.page.mybook.show_search=!o.$root.page.mybook.show_search}}},[s("img",{staticClass:"icon",attrs:{src:e("e67b")}})])])]):o._e(),o.$root.page.mybook.show_history?o._e():s("Books"),o.$root.page.mybook.show_history?s("History"):o._e()],1)},d=[],b=(e("a481"),e("bc3a")),u=e.n(b),k=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("transition",{attrs:{name:"ani-loading"}},[e("div",{staticClass:"fixed_full flex_center bg_01 loading"},[e("div",{staticClass:"loading-icon animation_rotate"})])])},g=[],f=(e("53a2"),{}),_=Object(r["a"])(f,k,g,!1,null,null,null),m=_.exports,y=function(){var o=this,t=o.$createElement,e=o._self._c||t;return o.$root.books?e("ul",{staticClass:"books"},o._l(o.$root.books,function(t){return e("li",{key:t.book_id,staticClass:"book"},[e("div",{staticClass:"cover"},[e("router-link",{attrs:{to:{name:"reader",params:{id:t.book_id,name:t.book_name}}}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:o.$root.api.cover+t.book_id+".webp",expression:"$root.api.cover + b.book_id + '.webp'"}]})])],1),e("div",{staticClass:"bookinfo"},[e("router-link",{staticClass:"book_name",attrs:{to:{name:"reader",params:{id:t.book_id,name:t.book_name}}}},[o._v(o._s(t.book_name))]),e("p",{staticClass:"book_brief"},[o._v("作者："+o._s(t.book_author.replace(/^\s+|\s+$/g,"")))]),e("p",{staticClass:"book_brief"},[o._v(o._s(t.book_brief))])],1)])}),0):o._e()},v=[],w=(e("0313"),{}),x=Object(r["a"])(w,y,v,!1,null,null,null),$=x.exports,C=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div",{staticClass:"history"},[o.$root.loading?e("Loading"):o._e(),o.$root.history?e("ul",{staticClass:"books"},o._l(Object.keys(this.$root.history),function(t){return e("li",{key:t,staticClass:"book"},[e("div",{staticClass:"cover"},[e("router-link",{attrs:{to:{name:"reader",params:{id:t,name:o.$root.history[t][1]}}}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:o.$root.api.cover+t+".webp",expression:"$root.api.cover + id + '.webp'"}]})])],1),e("div",{staticClass:"bookinfo"},[e("router-link",{staticClass:"book_name",attrs:{to:{name:"reader",params:{id:t,name:o.$root.history[t][1]}}}},[o._v(o._s(o.$root.history[t][1]))]),e("p",{staticClass:"book_brief"},[o._v("阅读进度 "+o._s(o.$root.history[t][0]))])],1)])}),0):o._e()],1)},O=[],S={name:"history",components:{Loading:m},mounted:function(){document.title="阅读记录",this.get_books_history()},methods:{get_books_history:function(){var o=this;this.$root.loading=!0,u.a.get(this.$root.api.history+"?action=get.all",{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(t){o.$root.history=t.data.history,localStorage.history=JSON.stringify(o.$root.history),o.$root.loading=!1})}}},j=S,N=Object(r["a"])(j,C,O,!1,null,null,null),P=N.exports,H={name:"mybook",components:{Loading:m,Books:$,History:P},directives:{focus:{inserted:function(o){o.focus()}}},mounted:function(){document.title="我的书架",this.get_books(""),this.get_books_history()},methods:{get_books_by_url:function(o){var t=this;if(o===this.$root.before_url)return"";this.$root.before_url=o,this.$root.loading=!0,u.a.get(o,{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(o){t.$root.books=o.data.books,0==t.$root.books.length&&alert("真的没有了")}).catch(function(o){o.response.status in{401:"",403:""}&&(delete localStorage["x-api-code"],location.assign("/#/login")),o.response.data.code in{429:""}&&alert("慢一点")}).finally(function(){t.$root.loading=!1})},get_books:function(){this.get_books_by_url(this.$root.api.books)},get_books_by_keyword:function(o){o=o.replace(/^\s+|\s+$/g,""),this.get_books_by_url(this.$root.api.books+"?action=find&keyword="+o)},get_random_books:function(){this.get_books_by_url(this.$root.api.books+"?action=random&ts="+(new Date).valueOf())},get_books_history:function(){var o=this;this.$root.loading=!0,u.a.get(this.$root.api.history+"?action=get.all",{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(t){o.$root.history=t.data.history,localStorage.history=JSON.stringify(o.$root.history),o.$root.loading=!1})}}},J=H,E=(e("cc9f"),Object(r["a"])(J,p,d,!1,null,null,null)),z=E.exports,L=function(){var o=this,t=o.$createElement,s=o._self._c||t;return s("div",{staticClass:"reader"},[s("Loading",{directives:[{name:"show",rawName:"v-show",value:o.show_loading,expression:"show_loading"}],style:o.styleObject}),s("ul",{directives:[{name:"show",rawName:"v-show",value:o.show_control,expression:"show_control"}],staticClass:"control bg shadow",style:o.styleObject},[s("li",[s("span",{on:{click:function(t){o.indexChange(-1),o.show_control=!o.show_control}}},[s("img",{staticClass:"icon",attrs:{src:e("c633")}})]),s("span",{on:{click:function(t){o.indexChange(1),o.show_control=!o.show_control}}},[s("img",{staticClass:"icon rotate180",attrs:{src:e("c633")}})])])]),s("ul",{directives:[{name:"show",rawName:"v-show",value:o.show_control,expression:"show_control"}],staticClass:"chapter_control control bg shadow",style:o.styleObject},[s("li",[s("div",{staticClass:"reader-buttons-top-left"},[s("span",{on:{click:function(t){o.book.track=!o.book.track}}},[o.book.track?s("img",{staticClass:"icon",attrs:{title:"取消跟踪",src:e("97d3")}}):o._e(),o.book.track?o._e():s("img",{staticClass:"icon",attrs:{title:"跟踪",src:e("fe05")}})]),s("span",[0==o.book.color?s("img",{staticClass:"icon",attrs:{title:"晴天",src:e("ffe1")},on:{click:function(t){o.book.color=1}}}):o._e(),1==o.book.color?s("img",{staticClass:"icon",attrs:{title:"阴天",src:e("dec2")},on:{click:function(t){o.book.color=2}}}):o._e(),2==o.book.color?s("img",{staticClass:"icon",attrs:{title:"对比",src:e("d843")},on:{click:function(t){o.book.color=0}}}):o._e()])]),s("span",{on:{click:function(t){o.show_chapters=!o.show_chapters}}},[s("img",{staticClass:"icon",attrs:{title:"显示目录",src:e("89c9")}})])])]),s("ul",{directives:[{name:"show",rawName:"v-show",value:o.show_chapters,expression:"show_chapters"}],staticClass:"chapter_control control bg shadow",style:o.styleObject},[s("li",[s("span",{directives:[{name:"show",rawName:"v-show",value:"asc"==o.book.chapters_sort_by,expression:"book.chapters_sort_by == 'asc'"}],on:{click:o.sortChapters}},[s("img",{staticClass:"icon rotate180",attrs:{title:"切换倒序",src:e("9710")}})]),s("span",{directives:[{name:"show",rawName:"v-show",value:"desc"==o.book.chapters_sort_by,expression:"book.chapters_sort_by == 'desc'"}],on:{click:o.sortChapters}},[s("img",{staticClass:"icon",attrs:{title:"切换正序",src:e("9710")}})]),s("span",{on:{click:function(t){o.show_chapters=!o.show_chapters,o.show_control=!o.show_control}}},[s("img",{staticClass:"icon",attrs:{title:"显示目录",src:e("e67b")}})])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:o.show_chapters,expression:"show_chapters"}],staticClass:"chapters bg",style:o.styleObject},[s("ul",{ref:"chapters",staticClass:"list"},o._l(o.book.chapters,function(t,e){return s("li",{key:e,staticClass:"border_top"},[s("p",{on:{click:function(e){o.book.index=t.index}}},[o._v(o._s(t.title))])])}),0)]),o.book.chapterHtml?s("div",{ref:"text",staticClass:"reader_text bg",style:o.styleObject,domProps:{innerHTML:o._s(o.book.chapterHtml)},on:{click:function(t){o.show_control=!o.show_control}}}):o._e()],1)},T=[],B=(e("ac6a"),e("456d"),e("55dd"),e("c5f6"),e("7f7f"),{name:"reader",components:{Loading:m},data:function(){return{book:{id:null,name:"",index:null,chapters:[],chapters_sort_by:"asc",chapterHtml:"",chapterCache:{},track:!1,color:null},show_control:0,show_loading:0,show_chapters:0,colors:{},styleObject:{}}},mounted:function(){this.book.color=0,this.book.id=this.$route.params.id,this.book.name=this.$route.params.name,this.book.name||(JSON.parse(localStorage.history).hasOwnProperty(this.book.id)?this.book.name=JSON.parse(localStorage.history)[this.book.id][1]:location.assign("/#/mybook")),console.log(this.book.id,this.book.name),document.title=this.book.name;var o=JSON.parse(localStorage.history);o.hasOwnProperty(this.book.id)?(this.book.index=o[this.book.id][0],this.book.track=!0):this.book.index=0,this.fetchCatalogue(),this.get_book_history()},methods:{indexChange:function(o){this.show_loading=1;var t=Number(this.book.index)+Number(o);this.book.chapters[t]?this.book.index=t:(-1==t?alert("已经是开始位置了"):t==this.book.chapters.length?alert("已经是结束位置了"):alert("奇怪的错误"),this.book.index=0,this.fetchChapter())},get_book_history:function(){var o=this;u.a.get(this.$root.api.history+"?action=get.one&book_id="+this.book.id,{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(t){var e=t.data.history[0];if(e>o.book.index){var s=confirm("继续阅读吗");s&&(o.book.index=e,o.book.name=t.data.history[1])}})},commit_book_history:function(){u.a.get(this.$root.api.history+"?action=insert&book_id="+this.book.id+"&book_name="+this.book.name+"&book_index="+this.book.index,{headers:{"x-api-code":localStorage["x-api-code"]}})},remove_book_history:function(){u.a.get(this.$root.api.history+"?action=remove&book_id="+this.book.id,{headers:{"x-api-code":localStorage["x-api-code"]}})},syncToHistory:function(){if(this.book.track){var o=JSON.parse(localStorage.history);o.hasOwnProperty(this.book.id)?o[this.book.id][0]=this.book.index:o[this.book.id]=[this.book.index,this.book.name],localStorage.history=JSON.stringify(o),this.commit_book_history()}},fetchChapter:function(){var o=this;this.show_loading=!0,u.a.get(this.$root.api.chapter+"?id="+this.book.id+"&index="+this.book.index,{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(t){if(o.book.chapterCache[o.book.id]=t.data.chapter,t.data.chapter){o.book.chapterHtml="";for(var e=0;e<t.data.chapter.length;e++)o.book.chapterHtml+="<p>"+t.data.chapter[e].replace(/^\s+|\s+$/g,"")+"</p>"}}).then(function(){o.syncToHistory(),"asc"==o.book.chapters_sort_by?document.title=o.book.chapters[o.book.index].title+" - "+o.book.name:document.title=o.book.chapters[o.book.chapters.length-1-o.book.index].title+" - "+o.book.name}).catch(function(o){o&&(404==o.response.status?(alert("错误代码 404"),location.assign("/#/mybook")):o.response.status in{400:"",401:"",403:""}?(alert("错误代码 400/401/403"),delete localStorage["x-api-code"],location.assign("/#/login")):(alert("意外错误"),location.assign("/#/mybook")))}).finally(function(){o.$refs.text.scrollTop=0,o.show_chapters=0,o.show_control=0,o.show_loading=0})},fetchCatalogue:function(){var o=this;this.show_loading=!0,u.a.get(this.$root.api.chapters+"?id="+this.book.id,{headers:{"x-api-code":localStorage["x-api-code"]}}).then(function(t){t.data.chapters?o.book.chapters=t.data.chapters:(alert("获取章节信息时出错"),location.assign("/#/mybook"))}).then(function(){o.fetchChapter()}).catch(function(o){o&&(404==o.response.status?(alert("错误代码 404"),location.assign("/#/mybook")):o.response.status in{400:"",401:"",403:""}?(alert("错误代码 400/401/403"),delete localStorage["x-api-code"],location.assign("/#/login")):(alert("意外错误"),location.assign("/#/mybook")))}).finally(function(){o.show_loading=!1})},sortChapters:function(){function o(o,t){var e="asc"==o?">":"<",s=new Function("a","b","return a."+t+e+"b."+t+"?1:-1");return s}"asc"==this.book.chapters_sort_by?this.book.chapters_sort_by="desc":this.book.chapters_sort_by="asc",this.book.chapters.sort(o(this.book.chapters_sort_by,"index"))}},watch:{"book.index":function(){this.fetchChapter()},"book.track":function(){if(this.book.track)this.syncToHistory();else{var o=JSON.parse(localStorage.history);o.hasOwnProperty(this.book.id)&&(delete o[this.book.id],this.remove_book_history()),localStorage.history=JSON.stringify(o)}},"book.color":function(){this.colors=this.$root.color.reader,console.log(this.colors[Object.keys(this.colors)[this.book.color]]),this.styleObject={color:this.colors[Object.keys(this.colors)[this.book.color]][0],"background-color":this.colors[Object.keys(this.colors)[this.book.color]][1]}}}}),M=B,F=(e("d207"),Object(r["a"])(M,L,T,!1,null,null,null)),D=F.exports,A=function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("Loading",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}]})},q=[],G={name:"login",components:{Loading:m},mounted:function(){var o=localStorage["x-api-code"];o?location.assign("/#/mybook"):(o=this.$route.query.code,o?(localStorage["x-api-code"]=o,location.assign("/#/mybook")):location.assign(this.$root.api.login))}},I=G,K=Object(r["a"])(I,A,q,!1,null,null,null),Q=K.exports;s["a"].use(h["a"]);var R=new h["a"]({routes:[{path:"/",redirect:"/login"},{path:"/login",name:"login",component:Q},{path:"/mybook",name:"Mybook",component:z},{path:"/reader/:id",name:"reader",component:D}]}),U={api:{login:"https://account.imhcg.cn/to/afdb06aa6a288b5eec4555d629477734",cover:"https://api.zxcs.imhcg.cn/static/cover@webp/",books:"https://api.zxcs.imhcg.cn/books",chapter:"https://api.zxcs.imhcg.cn/chapter",chapters:"https://api.zxcs.imhcg.cn/chapters",history:"https://api.zxcs.imhcg.cn/history"},page:{mybook:{keyword:"",show_search:!1,show_history:!1}},color:{reader:{C1:["#1A2B3C","#FCFAF2"],C2:["#CCCCCE","#444152"],C3:["#EDBE68","#0B5D6B"]}},loading:!1,books:[],history:{},before_url:""},V=U,W=e("caf9"),X=e("3dfc"),Y=e.n(X);s["a"].use(W["a"],{loading:Y.a,error:Y.a}),s["a"].config.productionTip=!1,new s["a"]({router:R,data:V,render:function(o){return o(l)}}).$mount("#app")},"64a9":function(o,t,e){},"79b7":function(o,t,e){},"89c9":function(o,t,e){o.exports=e.p+"img/drag.9871c605.svg"},9150:function(o,t,e){},9710:function(o,t,e){o.exports=e.p+"img/filter-alt.12332057.svg"},"97d3":function(o,t,e){o.exports=e.p+"img/heart-fill.c2681648.svg"},a6e4:function(o,t,e){},a714:function(o,t,e){o.exports=e.p+"img/shuffle.f018956d.svg"},c633:function(o,t,e){o.exports=e.p+"img/arrow-left.52d5c3f0.svg"},cc9f:function(o,t,e){"use strict";var s=e("79b7"),a=e.n(s);a.a},d0ad:function(o,t,e){o.exports=e.p+"img/book.dc9030fb.svg"},d207:function(o,t,e){"use strict";var s=e("9150"),a=e.n(s);a.a},d843:function(o,t,e){o.exports=e.p+"img/sunrise.d35e8a71.svg"},dec2:function(o,t,e){o.exports=e.p+"img/moon.567d1e3b.svg"},e67b:function(o,t,e){o.exports=e.p+"img/close.ee3eeead.svg"},f601:function(o,t,e){},fe05:function(o,t,e){o.exports=e.p+"img/heart-line.223ce9d3.svg"},ffe1:function(o,t,e){o.exports=e.p+"img/sun.f7542d32.svg"}});
//# sourceMappingURL=app.28b65626.js.map